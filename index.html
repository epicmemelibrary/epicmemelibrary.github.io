<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Library</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .meme {
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 20px;
      max-width: 500px;
    }
    .meme img {
      max-width: 100%;
      display: block;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

<h1>Library</h1>
<div id="gallery">Loading memes...</div>

<script>
const owner = "brainhealth-meme-library";
const repo = "brainhealth-meme-library.github.io";

async function loadGallery() {
  const gallery = document.getElementById("gallery");

  const response = await fetch(
    `https://api.github.com/repos/${owner}/${repo}/contents/memes`
  );

  if (!response.ok) {
    gallery.textContent = "Error loading memes.";
    return;
  }

  const files = await response.json();
  gallery.innerHTML = "";

  for (const file of files) {
    if (file.name.endsWith(".json")) {
      const memeData = await fetch(file.download_url).then(r => r.json());

      const div = document.createElement("div");
      div.className = "meme";

      const img = document.createElement("img");
      img.src = memeData.previewBase64;

      const info = document.createElement("div");
      info.innerHTML = `
        <b>Top:</b> ${memeData.top}<br>
        <b>Bottom:</b> ${memeData.bottom}<br>
        <b>Base Image:</b> ${memeData.baseImage}<br>
        <b>Submitted:</b> ${new Date(memeData.timestamp).toLocaleString()}
      `;

      div.appendChild(img);
      div.appendChild(info);
      gallery.appendChild(div);
    }
  }
}

loadGallery();
</script>

</body>
</html>
