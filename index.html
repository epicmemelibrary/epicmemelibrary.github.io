<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Library of Memes</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }

    .meme {
      position: relative;
      display: inline-block;
      margin-bottom: 40px;
      max-width: 500px;
    }

    .meme img {
      width: 100%;
      height: auto;
      display: block;
    }

    .caption {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      text-align: center;
      color: white;
      font-size: 2em;
      font-weight: bold;
      text-shadow:
        2px 2px 0 black,
        -2px 2px 0 black,
        2px -2px 0 black,
        -2px -2px 0 black;
      pointer-events: none;
      word-wrap: break-word;
    }

    .top-caption {
      top: 10px;
    }

    .bottom-caption {
      bottom: 10px;
    }
  </style>
</head>
<body>

<h1 style="text-align: center;">The Library of Epic Memes</h1>
  <a href="https://epicmemelibrary.github.io/new.html">+New+</a> --- <a href="https://epicmemelibrary.github.io/tags.html">Tags</a> --- <a href="https://epicmemelibrary.github.io/tags.html">Collections</a> --- <a href="https://docs.google.com/forms/d/e/1FAIpQLSfg2kJJox8XPTScxLq5vTAjtHGfoDiwI_rCEAEvgYh0mDhNEQ/viewform?usp=dialog" target="_blank">Submit</a> --- <a href="mailto:bgbrbx@gmail.com?subject=Meme-Library:">Contact</a>
<div id="gallery">Loading memes...</div>

<script>
const owner = "epicmemelibrary";
const repo = "epicmemelibrary.github.io";

async function loadGallery() {
  const gallery = document.getElementById("gallery");

  const response = await fetch(
    `https://api.github.com/repos/${owner}/${repo}/contents/memes`
  );

  if (!response.ok) {
    gallery.textContent = "Error loading memes.";
    return;
  }

  const files = await response.json();
  gallery.innerHTML = "";

  for (const file of files) {
    if (file.name.endsWith(".json")) {
      const memeData = await fetch(file.download_url).then(r => r.json());

      // Create meme container
      const memeDiv = document.createElement("div");
      memeDiv.className = "meme";

      // Use the ORIGINAL base image so GIFs animate
      const img = document.createElement("img");
      img.src = `https://raw.githubusercontent.com/${owner}/${repo}/main/samples/${memeData.baseImage}`;

      // Captions
      const topCap = document.createElement("div");
      topCap.className = "caption top-caption";
      topCap.textContent = memeData.top;

      const bottomCap = document.createElement("div");
      bottomCap.className = "caption bottom-caption";
      bottomCap.textContent = memeData.bottom;

      // Add everything
      memeDiv.appendChild(img);
      memeDiv.appendChild(topCap);
      memeDiv.appendChild(bottomCap);

      gallery.appendChild(memeDiv);
    }
  }
}

loadGallery();
</script>

</body>
</html>
